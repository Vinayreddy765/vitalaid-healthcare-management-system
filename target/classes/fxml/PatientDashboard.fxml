<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="controller.PatientController" styleClass="dashboard-root">

    <!-- Top Navigation Bar -->
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" styleClass="navbar">
            <padding>
                <Insets top="15" right="30" bottom="15" left="30"/>
            </padding>

            <VBox>
                <Text text="VitalAid" styleClass="navbar-title"/>
                <Text text="Patient Dashboard" styleClass="navbar-subtitle"/>
            </VBox>

            <Region HBox.hgrow="ALWAYS"/>

            <Button fx:id="notificationButton" styleClass="icon-button" onAction="#showNotifications">
                <graphic>
                    <HBox alignment="CENTER">
                        <Text text="ðŸ””" styleClass="notification-icon"/>
                        <Label fx:id="notificationBadge" styleClass="notification-badge" visible="false"/>
                    </HBox>
                </graphic>
            </Button>

            <MenuButton styleClass="user-menu">
                <graphic>
                    <HBox spacing="10" alignment="CENTER">
                        <Text text="ðŸ‘¤" style="-fx-font-size: 24px;"/>
                        <VBox alignment="CENTER_LEFT">
                            <Text fx:id="userName" text="Patient Name" styleClass="user-name"/>
                            <Text text="Patient" styleClass="user-role"/>
                        </VBox>
                    </HBox>
                </graphic>
                <items>
                    <MenuItem text="My Profile"/>
                    <MenuItem text="Settings"/>
                    <SeparatorMenuItem/>
                    <MenuItem text="Logout" onAction="#handleLogout"/>
                </items>
            </MenuButton>
        </HBox>
    </top>

    <!-- Main Scrollable Content -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="content-scroll">
            <VBox spacing="25" styleClass="dashboard-content">
                <padding>
                    <Insets top="30" right="30" bottom="30" left="30"/>
                </padding>

                <!-- Welcome Section -->
                <VBox spacing="10" styleClass="welcome-section">
                    <Text fx:id="welcomeText" text="Welcome!" styleClass="welcome-title"/>
                    <Text text="Request blood, plasma, or ventilator support when you need it most."
                          styleClass="welcome-subtitle"/>
                </VBox>

                <!-- Quick Action Cards -->
                <HBox spacing="20" alignment="CENTER">
                    <VBox spacing="15" styleClass="stat-card-highlight" prefWidth="350" alignment="CENTER">
                        <padding>
                            <Insets top="30" right="20" bottom="30" left="20"/>
                        </padding>
                        <Text text="ðŸ©¸" style="-fx-font-size: 48px;"/>
                        <Text text="Request Blood" style="-fx-font-size: 18px; -fx-fill: white; -fx-font-weight: bold;"/>
                        <Button text="Create Request" styleClass="btn-primary" 
                                onAction="#createBloodRequest" prefWidth="200" prefHeight="40"/>
                    </VBox>

                    <VBox spacing="15" styleClass="stat-card-highlight" prefWidth="350" alignment="CENTER">
                        <padding>
                            <Insets top="30" right="20" bottom="30" left="20"/>
                        </padding>
                        <Text text="ðŸ’‰" style="-fx-font-size: 48px;"/>
                        <Text text="Request Plasma" style="-fx-font-size: 18px; -fx-fill: white; -fx-font-weight: bold;"/>
                        <Button text="Create Request" styleClass="btn-primary" 
                                onAction="#createPlasmaRequest" prefWidth="200" prefHeight="40"/>
                    </VBox>

                    <VBox spacing="15" styleClass="stat-card-highlight" prefWidth="350" alignment="CENTER">
                        <padding>
                            <Insets top="30" right="20" bottom="30" left="20"/>
                        </padding>
                        <Text text="ðŸ¥" style="-fx-font-size: 48px;"/>
                        <Text text="Request Ventilator" style="-fx-font-size: 18px; -fx-fill: white; -fx-font-weight: bold;"/>
                        <Button text="Create Request" styleClass="btn-primary" 
                                onAction="#createVentilatorRequest" prefWidth="200" prefHeight="40"/>
                    </VBox>
                </HBox>

                <!-- My Requests Section -->
                <VBox spacing="15" styleClass="content-card">
                    <padding>
                        <Insets top="20" right="20" bottom="20" left="20"/>
                    </padding>

                    <HBox alignment="CENTER_LEFT">
                        <Text text="ðŸ“‹ My Requests" styleClass="section-title"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="Refresh" styleClass="btn-secondary" onAction="#refreshRequests"/>
                    </HBox>

                    <Separator/>

                    <TableView fx:id="requestsTable" prefHeight="300">
                        <columns>
                            <TableColumn fx:id="requestIdColumn" text="ID" prefWidth="60"/>
                            <TableColumn fx:id="requestTypeColumn" text="Type" prefWidth="120"/>
                            <TableColumn fx:id="bloodGroupColumn" text="Blood Group" prefWidth="100"/>
                            <TableColumn fx:id="quantityColumn" text="Quantity" prefWidth="100"/>
                            <TableColumn fx:id="urgencyColumn" text="Urgency" prefWidth="100"/>
                            <TableColumn fx:id="statusColumn" text="Status" prefWidth="120"/>
                            <TableColumn fx:id="dateColumn" text="Date" prefWidth="150"/>
                            <TableColumn fx:id="actionColumn" text="Action" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>

                <!-- Hospitals & Profile Grid -->
                <GridPane hgap="20" vgap="20">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="50"/>
                        <ColumnConstraints percentWidth="50"/>
                    </columnConstraints>

                    <!-- Nearby Hospitals -->
                    <VBox spacing="15" styleClass="content-card" GridPane.columnIndex="0" GridPane.rowIndex="0">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Text text="ðŸ¥ Nearby Hospitals" styleClass="section-title"/>
                        <Separator/>
                        <ListView fx:id="hospitalsList" prefHeight="250"/>
                        <Button text="Find More Hospitals" styleClass="btn-outline" 
                                onAction="#findHospitals" prefHeight="40"/>
                    </VBox>

                    <!-- My Profile -->
                    <VBox spacing="15" styleClass="content-card" GridPane.columnIndex="1" GridPane.rowIndex="0">
                        <padding>
                            <Insets top="20" right="20" bottom="20" left="20"/>
                        </padding>
                        <Text text="ðŸ‘¤ My Profile" styleClass="section-title"/>
                        <Separator/>
                        <GridPane hgap="15" vgap="12">
                            <columnConstraints>
                                <ColumnConstraints minWidth="120" prefWidth="120"/>
                                <ColumnConstraints minWidth="200" prefWidth="200"/>
                            </columnConstraints>

                            <Label text="Full Name:" styleClass="profile-label" 
                                   GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                            <Text fx:id="fullNameText" text="-" styleClass="profile-value" 
                                  GridPane.columnIndex="1" GridPane.rowIndex="0"/>
                            
                            <Label text="Blood Group:" styleClass="profile-label" 
                                   GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                            <Text fx:id="bloodGroupText" text="-" styleClass="profile-value" 
                                  GridPane.columnIndex="1" GridPane.rowIndex="1"/>
                            
                            <Label text="Age:" styleClass="profile-label" 
                                   GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                            <Text fx:id="ageText" text="-" styleClass="profile-value" 
                                  GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                            
                            <Label text="City:" styleClass="profile-label" 
                                   GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                            <Text fx:id="cityText" text="-" styleClass="profile-value" 
                                  GridPane.columnIndex="1" GridPane.rowIndex="3"/>
                            
                            <Label text="Emergency Contact:" styleClass="profile-label" 
                                   GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                            <Text fx:id="emergencyContactText" text="-" styleClass="profile-value" 
                                  GridPane.columnIndex="1" GridPane.rowIndex="4"/>
                        </GridPane>
                    </VBox>
                </GridPane>

            </VBox>
        </ScrollPane>
    </center>

</BorderPane>